!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.zj0724common=t():e.zj0724common=t()}(self,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{BasePO:()=>c,BaseService:()=>p,DatabaseService:()=>f,HttpRequest:()=>s,InfoException:()=>r,Query:()=>l,QueryResult:()=>d,ResponseResult:()=>o,Service:()=>u,base64:()=>m,file:()=>g,http:()=>h,httpType:()=>n,popupUtil:()=>b,promise:()=>O,variable:()=>a});class r extends Error{constructor(e){super(e)}}const s=class{url;type;header;param;data;constructor(e){this.url=e.url,this.type=e.type,this.header=e.header?e.header:{},this.param=e.param?e.param:{},this.data=e.data?e.data:{}}};var i;!function(e){e.POST="POST",e.GET="GET",e.PUT="PUT",e.DELETE="DELETE"}(i||(i={}));const n=i,a={isNull:e=>null==e,isEmpty(e){if(this.isNull(e))return!0;let t=this.getType(e);return t===String&&""===e||t===Array&&0===e.length||t===Object&&0===Object.keys(e).length},getType(e){return this.isNull(e)?null:e.constructor},isObject(e){if(this.isNull(e))return!1;if(e instanceof Object){let t=this.getType(e);return null!=t&&(void 0!==JSON.stringify(e)||0===t.toString().indexOf("class")||t===Array||t===Object)}return!1},clone(e){if(this.isObject(e)){if(this.getType(e)===Array){let t=[];for(let r of e)t.push(this.clone(r));return t}{let t={};for(let r in e)if(e.hasOwnProperty(r)){let s=e[r];this.isObject(s)?t[r]=this.clone(s):t[r]=null}return this.assignment(t,e),t}}return this.isNull(e)?null:e},assignment(e,t,r){let s=this.getType(e),i=!!this.isEmpty(r)||!0===r;if(this.isObject(e)&&this.isObject(t))if(s===Array){let r=!0;if(i&&this.getType(t)!==Array&&(r=!1),s!==this.getType(t)&&(r=!1),r){e.splice(0,e.length);for(let r of t)e.push(this.clone(r))}}else for(let r in e){let s=e[r],n=t[r];void 0!==n&&(null!=s&&i&&(null!==n||this.isObject(s))?this.getType(s)===this.getType(n)&&(e[r]=this.clone(n)):e[r]=this.clone(n))}},toStr(e){return this.isNull(e)?null:this.isObject(e)?JSON.stringify(e):e.toString()},clean(e){if(this.isObject(e))for(let t in e)if(e.hasOwnProperty(t)){let r=e[t];this.getType(r)===Array?e[t]=[]:this.isObject(r)?this.clean(r):e[t]=null}},addKey(e,t){if(this.isObject(e)&&this.isObject(t))for(let r in t){let s=t[r];this.isNull(e[r])&&(this.isObject(s)?this.getType(s)===Array?e[r]=[]:e[r]={}:e[r]=null),this.addKey(e[r],s)}}};class l{page;size;filter;sort;constructor(e){a.assignment(this,e)}}class o{flag=!1;code;message;result=null;constructor(e){a.assignment(this,e)}}class d{count=0;data=[]}class c{id}const h={send(e){return new Promise(((t,r)=>{let s=this._getUrl(e),i=e.type,l=e.header?e.header:{},o=e.data,d=!1;if(a.isObject(o)){for(let e in o){let t=a.getType(o[e]);if(t===File||t===FileList){d=!0;break}if(t===Array)for(let t of o[e])if(a.getType(t)===File||a.getType(t)===FileList){d=!0;break}}if(d){let e=new FormData;for(let t in o){let r=o[t];if(a.getType(r)===FileList)for(let s of r)e.append(t,s);else if(a.getType(r)===Array)for(let s of r)e.append(t,s);else e.append(t,r)}o=e}}a.isObject(o)&&a.getType(o)!==FormData&&(o=JSON.stringify(o)),i===n.GET||d||(l["content-type"]="application/json"),fetch(s,{cache:"no-cache",credentials:"same-origin",mode:"cors",redirect:"follow",referrer:"no-referrer",method:i,headers:l,body:o}).then((e=>{let s=e.text();e.ok?t(s):r(s)})).catch((e=>{r(e)}))}))},download(e){return new Promise(((t,r)=>{try{window.open(this._getUrl(e)),t()}catch(e){r(e)}}))},asyncDownload(e){return new Promise(((t,r)=>{fetch(this._getUrl(e)).then((e=>{e.blob().then((s=>{try{let r=document.createElement("a"),i=window.URL.createObjectURL(s),n=e.headers.get("Content-Disposition");n=n||"";let a=/filename=(.*?)$/g.exec(n);null!==a&&(n=a[1]),r.href=i,r.download=n,r.click(),window.URL.revokeObjectURL(i),t()}catch(e){r(e)}}))}))}))},_getUrl(e){let t=e.url,r=e.param?e.param:{};if(!a.isEmpty(r)){let e="?";for(let t in r){let s=r[t];a.isEmpty(s)||(e=e+t+"="+s+"&")}e="?"!==e?e.substring(0,e.length-1):"",t+=e}return t}};class u{url;data={};constructor(e){this.url=e}$send(e,t){return new Promise(((s,i)=>{let n=e.url,l=e.type,o=e.header,d=e.data,c=e.param;if(a.isEmpty(n))throw new r("方法名 is null");if(a.isEmpty(l))throw new r("type is null");a.isEmpty(this.data[n])&&(this.data[n]={request:null,response:null}),null!=d&&(this.data[n].request=d),(a.isEmpty(t)||void 0===t)&&(t=()=>{});let u={url:this.url+"/"+n,type:l,header:o,data:this.data[n].request,param:c};t(u),this.$requestHandler(u),h.send(u).then((e=>{let t;a.clean(this.data[n].response);try{t=JSON.parse(e)}catch(r){t=e}a.isObject(this.data[n].response)?(a.addKey(this.data[n].response,t),a.assignment(this.data[n].response,t)):this.data[n].response=t,s(this.data[n].response)})).catch((e=>{i(e)}))}))}$download(e,t){return new Promise(((s,i)=>{let l=e.url,o=e.param;if(a.isEmpty(l))throw new r("方法名 is null");a.isEmpty(this.data[l])&&(this.data[l]={request:null,response:null}),void 0!==o&&(this.data[l].request=o),(void 0===t||a.isEmpty(t))&&(t=()=>{});let d={url:this.url+"/"+l,type:n.GET,param:this.data[l].request};t(d),this.$requestHandler(d),h.download(d).then((()=>{s()})).catch((e=>{i(e)}))}))}$requestHandler(e){}$addData(e,t,r){void 0===t&&(t=null),void 0===r&&(r=null),this.data[e]={request:t,response:r}}}class p extends u{data={};constructor(e){super(e)}$send(e,t){return new Promise(((r,s)=>{super.$send(e,t).then((e=>{e.flag?r(e):s(e)})).catch((e=>{s(e)}))}))}}class f extends p{data;constructor(e,t,r){super(e),this.data={query:{request:new l({filter:r}),response:new o({result:new d})},save:{request:a.clone(t),response:new o},saveList:{request:[],response:new o},delete:{request:a.clone(t),response:new o},deleteList:{request:[],response:new o}}}query(e){return this.$send({url:"query",type:n.POST,data:e})}save(e){return this.$send({url:"save",type:n.POST,data:e})}saveList(e){return this.$send({url:"saveList",type:n.POST,data:e})}doDelete(e){return this.$send({url:"delete",type:n.POST,data:e})}deleteList(e){return this.$send({url:"deleteList",type:n.POST,data:e})}}let y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";const m={encode(e){let t,r,s,i,n,a,l,o="",d=0;for(e=function(e){let t="";e=e.replace(/\r\n/g,"\n");for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t+=String.fromCharCode(s):s>127&&s<2048?(t+=String.fromCharCode(s>>6|192),t+=String.fromCharCode(63&s|128)):(t+=String.fromCharCode(s>>12|224),t+=String.fromCharCode(s>>6&63|128),t+=String.fromCharCode(63&s|128))}return t}(e);d<e.length;)t=e.charCodeAt(d++),r=e.charCodeAt(d++),s=e.charCodeAt(d++),i=t>>2,n=(3&t)<<4|r>>4,a=(15&r)<<2|s>>6,l=63&s,isNaN(r)?a=l=64:isNaN(s)&&(l=64),o=o+y.charAt(i)+y.charAt(n)+y.charAt(a)+y.charAt(l);return o},decode(e){let t,r,s,i,n,a,l,o="",d=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");d<e.length;)i=y.indexOf(e.charAt(d++)),n=y.indexOf(e.charAt(d++)),a=y.indexOf(e.charAt(d++)),l=y.indexOf(e.charAt(d++)),t=i<<2|n>>4,r=(15&n)<<4|a>>2,s=(3&a)<<6|l,o+=String.fromCharCode(t),64!==a&&(o+=String.fromCharCode(r)),64!==l&&(o+=String.fromCharCode(s));return o=function(e){let t,r,s="",i=0,n=0;for(;i<e.length;)t=e.charCodeAt(i),t<128?(s+=String.fromCharCode(t),i++):t>191&&t<224?(r=e.charCodeAt(i+1),s+=String.fromCharCode((31&t)<<6|63&r),i+=2):(r=e.charCodeAt(i+1),n=e.charCodeAt(i+2),s+=String.fromCharCode((15&t)<<12|(63&r)<<6|63&n),i+=3);return s}(o),o}},g={select:()=>new Promise((e=>{let t=document.createElement("input");t.type="file",t.addEventListener("change",(function(){let r=t.files;null===r?e():e(r[0])})),t.click()})),selectMore:()=>new Promise((e=>{let t=document.createElement("input");t.type="file",t.multiple=!0,t.addEventListener("change",(function(){let r=t.files;e(r)})),t.click()}))},O={then:(e,t)=>new Promise(((r,s)=>{e.then((e=>{t(e),r(e)})).catch((e=>{s(e)}))}))},b={create:e=>({loading:!1,display:!1,...e,async open(t){this.display=!0,this.loading=!0,e.openHandler&&await e.openHandler(t),this.loading=!1},close(){this.display=!1}})};return t})()));