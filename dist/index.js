!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.zj0724common=t():e.zj0724common=t()}(self,(()=>(()=>{"use strict";var e={d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{BasePO:()=>h,BaseService:()=>c,DatabaseService:()=>d,HttpOption:()=>s,InfoException:()=>r,Query:()=>l,ResponseResult:()=>a,base64:()=>p,file:()=>y,http:()=>u,httpType:()=>n,promise:()=>g,variable:()=>o});class r extends Error{constructor(e){super(e)}}const s=class{url;type;header;urlData;data;constructor(e){this.url=e.url,this.type=e.type,this.header=e.header?e.header:{},this.urlData=e.urlData?e.urlData:{},this.data=e.data?e.data:{}}};var i;!function(e){e.POST="POST",e.GET="GET",e.PUT="PUT",e.DELETE="DELETE"}(i||(i={}));const n=i;class l{page;size;filter={};sort={}}const o={isNull:e=>null==e,isEmpty(e){if(this.isNull(e))return!0;let t=this.getType(e);return t===String&&""===e||t===Array&&0===e.length||t===Object&&0===Object.keys(e).length},getType(e){return this.isNull(e)?null:e.constructor},isObject(e){if(this.isNull(e))return!1;if(e instanceof Object){let t=this.getType(e);return null!=t&&(void 0!==JSON.stringify(e)||0===t.toString().indexOf("class")||t===Array||t===Object)}return!1},clone(e){if(this.isObject(e)){if(this.getType(e)===Array){let t=[];for(let r of e)t.push(this.clone(r));return t}{let t={};for(let r in e)if(e.hasOwnProperty(r)){let s=e[r];this.isObject(s)?t[r]=this.clone(s):t[r]=null}return this.assignment(t,e),t}}return this.isNull(e)?null:e},assignment(e,t,r){let s=this.getType(e);if(this.isObject(e)&&this.isObject(t))if(s===Array){let i=!0;if(!0===r&&this.getType(t)!==Array&&(i=!1),s!==this.getType(t)&&(i=!1),i){e.splice(0,e.length);for(let r of t)e.push(this.clone(r))}}else for(let s in e)if(e.hasOwnProperty(s)){let i=e[s],n=t[s];if(void 0===n)continue;this.isObject(i)?this.getType(i)===this.getType(n)?this.assignment(i,n):!this.isNull(r)&&this.getType(r)===Boolean&&r||(e[s]=this.clone(n)):!this.isNull(r)&&this.getType(r)===Boolean&&r?(this.isNull(i)||this.getType(i)===this.getType(n))&&(e[s]=this.clone(n)):e[s]=this.clone(n)}},toStr(e){return this.isNull(e)?null:this.isObject(e)?JSON.stringify(e):e.toString()},clean(e){if(this.isObject(e))for(let t in e)if(e.hasOwnProperty(t)){let r=e[t];this.getType(r)===Array?e[t]=[]:this.isObject(r)?this.clean(r):e[t]=null}},getValue(e,t){return this.isNull(e)||this.isEmpty(t)?null:e[t]},setValue(e,t,r){this.isNull(e)||this.isEmpty(t)||(e[t]=r)}};class a{flag;code;message;result;constructor(e){o.assignment(this,e)}}class h{id}const u={send(e){return new Promise(((t,r)=>{let s=this._getUrl(e),i=e.type,l=e.header?e.header:{},a=e.data,h=!1;if(o.isObject(a)){for(let e in a)if(o.getType(a[e])===File){h=!0;break}if(h){let e=new FormData;for(let t in a)e.append(t,a[t]);a=e}}o.isObject(a)&&o.getType(a)!==FormData&&(a=JSON.stringify(a)),i===n.GET||h||(l["content-type"]="application/json"),fetch(s,{cache:"no-cache",credentials:"same-origin",mode:"cors",redirect:"follow",referrer:"no-referrer",method:i,headers:l,body:a}).then((e=>{let s=e.text();e.ok?t(s):r(s)}))}))},download(e){return new Promise(((t,r)=>{try{window.open(this._getUrl(e)),t()}catch(e){r(e)}}))},asyncDownload(e){return new Promise(((t,r)=>{fetch(this._getUrl(e)).then((e=>{e.blob().then((s=>{try{let r=document.createElement("a"),i=window.URL.createObjectURL(s),n=e.headers.get("Content-Disposition");n=n||"";let l=/filename=(.*?)$/g.exec(n);null!==l&&(n=l[1]),r.href=i,r.download=n,r.click(),window.URL.revokeObjectURL(i),t()}catch(e){r(e)}}))}))}))},_getUrl(e){let t=e.url,r=e.urlData?e.urlData:{};if(!o.isEmpty(r)){let e="?";for(let t in r){let s=r[t];o.isEmpty(s)||(e=e+t+"="+s+"&")}e="?"!==e?e.substring(0,e.length-1):"",t+=e}return t}};class c{url;data={};constructor(e){this.url=e}$send(e,t,s,i){return new Promise(((n,l)=>{if(o.isEmpty(e))throw new r("方法名 is null");if(o.isEmpty(t))throw new r("type is null");o.isEmpty(this.data[e])&&(this.data[e]={request:null,response:null}),void 0!==s&&(this.data[e].request=s),(void 0===i||o.isEmpty(i))&&(i=e=>e);let h={url:this.url+"/"+e,type:t,data:this.data[e].request};h=i(h),h=this.$requestHandler(h),u.send(h).then((t=>{let r=JSON.parse(t),s=new a(r);this.data[e].response=s,s.flag?n(s):l(s)})).catch((e=>{l(e)}))}))}$download(e,t,s){return new Promise(((i,l)=>{if(o.isEmpty(e))throw new r("方法名 is null");o.isEmpty(this.data[e])&&(this.data[e]={request:null,response:null}),void 0!==t&&(this.data[e].request=t),(void 0===s||o.isEmpty(s))&&(s=e=>e);let a={url:this.url+"/"+e,type:n.GET,urlData:this.data[e].request};a=s(a),a=this.$requestHandler(a),u.download(a).then((()=>{i()})).catch((e=>{l(e)}))}))}$requestHandler(e){return e}$addData(e,t,r){void 0===t&&(t={}),this.data[e]={request:t,response:new a({result:r})}}}class d extends c{data;constructor(e,t){super(e),this.data={query:{request:new l,response:new a({result:{count:null,data:null}})},save:{request:void 0===t?null:t,response:new a},saveList:{request:void 0===t?null:[],response:new a},delete:{request:void 0===t?null:t,response:new a},deleteList:{request:void 0===t?null:[],response:new a}}}query(e){return this.$send("query",n.POST,e)}save(e){return this.$send("save",n.POST,e)}saveList(e){return this.$send("saveList",n.POST,e)}doDelete(e){return this.$send("delete",n.POST,e)}deleteList(e){return this.$send("deleteList",n.POST,e)}}let f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";const p={encode(e){let t,r,s,i,n,l,o,a="",h=0;for(e=function(e){let t="";e=e.replace(/\r\n/g,"\n");for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t+=String.fromCharCode(s):s>127&&s<2048?(t+=String.fromCharCode(s>>6|192),t+=String.fromCharCode(63&s|128)):(t+=String.fromCharCode(s>>12|224),t+=String.fromCharCode(s>>6&63|128),t+=String.fromCharCode(63&s|128))}return t}(e);h<e.length;)t=e.charCodeAt(h++),r=e.charCodeAt(h++),s=e.charCodeAt(h++),i=t>>2,n=(3&t)<<4|r>>4,l=(15&r)<<2|s>>6,o=63&s,isNaN(r)?l=o=64:isNaN(s)&&(o=64),a=a+f.charAt(i)+f.charAt(n)+f.charAt(l)+f.charAt(o);return a},decode(e){let t,r,s,i,n,l,o,a="",h=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)i=f.indexOf(e.charAt(h++)),n=f.indexOf(e.charAt(h++)),l=f.indexOf(e.charAt(h++)),o=f.indexOf(e.charAt(h++)),t=i<<2|n>>4,r=(15&n)<<4|l>>2,s=(3&l)<<6|o,a+=String.fromCharCode(t),64!==l&&(a+=String.fromCharCode(r)),64!==o&&(a+=String.fromCharCode(s));return a=function(e){let t,r,s="",i=0,n=0;for(;i<e.length;)t=e.charCodeAt(i),t<128?(s+=String.fromCharCode(t),i++):t>191&&t<224?(r=e.charCodeAt(i+1),s+=String.fromCharCode((31&t)<<6|63&r),i+=2):(r=e.charCodeAt(i+1),n=e.charCodeAt(i+2),s+=String.fromCharCode((15&t)<<12|(63&r)<<6|63&n),i+=3);return s}(a),a}},y={select:()=>new Promise((e=>{let t=document.createElement("input");t.type="file",t.addEventListener("change",(function(){let r=t.files;e(null===r?null:r[0])})),t.click()}))},g={then:(e,t)=>new Promise(((r,s)=>{e.then((e=>{t(e),r(e)})).catch((e=>{s(e)}))}))};return t})()));