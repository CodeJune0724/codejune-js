(function(u,w){typeof exports=="object"&&typeof module<"u"?w(exports):typeof define=="function"&&define.amd?define(["exports"],w):(u=typeof globalThis<"u"?globalThis:u||self,w(u["zj0724-common"]={}))})(this,function(u){"use strict";var w=(()=>`.auto-break{word-break:break-all}.no-break{white-space:nowrap}.center{display:flex;justify-content:center;align-items:center}
`)();class O extends Error{constructor(e){super(e)}}class A{constructor(e){this.url=e.url,this.type=e.type,this.header=e.header?e.header:{},this.param=e.param?e.param:{},this.data=e.data?e.data:{},this.config=e.config}}var p=(t=>(t.POST="POST",t.GET="GET",t.PUT="PUT",t.DELETE="DELETE",t))(p||{}),h={isNull(t){return t==null},isEmpty(t){if(this.isNull(t))return!0;let e=this.getType(t);return e===String&&t===""||e===Array&&t.length===0?!0:e===Object&&Object.keys(t).length===0},getType(t){return this.isNull(t)?null:t.constructor},isObject(t){if(this.isNull(t))return!1;if(t instanceof Object){let e=this.getType(t);return e==null?!1:JSON.stringify(t)!==void 0||e.toString().indexOf("class")===0||e===Array?!0:e===Object}return!1},clone(t){if(this.isObject(t))if(this.getType(t)===Array){let e=[];for(let i of t)e.push(this.clone(i));return e}else{let e={};for(let i in t)if(t.hasOwnProperty(i)){let r=t[i];this.isObject(r)?e[i]=this.clone(r):e[i]=null}return this.assignment(e,t),e}else return this.isNull(t)?null:t},assignment(t,e,i){let r=this.getType(t),n=this.isEmpty(i)?!0:i===!0;if(this.isObject(t)&&this.isObject(e))if(r===Array){let s=!0;if(n&&this.getType(e)!==Array&&(s=!1),r!==this.getType(e)&&(s=!1),s){t.splice(0,t.length);for(let l of e)t.push(this.clone(l))}}else for(let s in t){let l=t[s],a=e[s];if(a!==void 0){if(l==null){t[s]=this.clone(a);continue}n?a===null&&!this.isObject(l)?t[s]=this.clone(a):this.getType(l)===this.getType(a)&&(t[s]=this.clone(a)):t[s]=this.clone(a)}}},toStr(t){return this.isNull(t)?null:this.isObject(t)?JSON.stringify(t):t.toString()},clean(t){if(this.isObject(t)){for(let e in t)if(t.hasOwnProperty(e)){let i=t[e];this.getType(i)===Array?t[e]=[]:this.isObject(i)?this.clean(i):t[e]=null}}},addKey(t,e){if(!(!this.isObject(t)||!this.isObject(e)))for(let i in e){let r=e[i];this.isNull(t[i])&&(this.isObject(r)?this.getType(r)===Array?t[i]=[]:t[i]={}:t[i]=null),this.addKey(t[i],r)}}};class T{constructor(e){h.assignment(this,e)}}class g{constructor(e){this.flag=!1,this.result=null,h.assignment(this,e)}}class S{constructor(){this.count=0,this.data=[]}}class k{}var v={send(t){return new Promise((e,i)=>{let r=this._getUrl(t),n=t.type,s=t.header?t.header:{},l=t.data,a=t.config,f=!1;if(h.isObject(l)){for(let o in l){let c=h.getType(l[o]);if(c===File||c===FileList){f=!0;break}if(c===Array){for(let d of l[o])if(h.getType(d)===File||h.getType(d)===FileList){f=!0;break}}}if(f){let o=new FormData;for(let c in l){let d=l[c];if(h.getType(d)===FileList)for(let y of d)o.append(c,y);else if(h.getType(d)===Array)for(let y of d)o.append(c,y);else o.append(c,d)}l=o}}if(h.isObject(l)&&h.getType(l)!==FormData){let o="BODY";switch(a&&(o=a.dataType),o){case"BODY":l=JSON.stringify(l);break;case"FORM_DATA":let c=new FormData;for(let d in l)c.append(d,l[d]);l=c;break}}n!==p.GET&&!f&&(s["content-type"]="application/json"),fetch(r,{cache:"no-cache",credentials:"same-origin",mode:"cors",redirect:"follow",referrer:"no-referrer",method:n,headers:s,body:l}).then(o=>{let c=o.text();o.ok?e(c):i(c)}).catch(o=>{i(o)})})},download(t){return new Promise((e,i)=>{try{window.open(this._getUrl(t)),e()}catch(r){i(r)}})},asyncDownload(t){return new Promise((e,i)=>{fetch(this._getUrl(t)).then(r=>{r.blob().then(n=>{try{let s=document.createElement("a"),l=window.URL.createObjectURL(n),a=r.headers.get("Content-Disposition");a=a||"";let o=/filename=(.*?)$/g.exec(a);o!==null&&(a=o[1]),s.href=l,s.download=a,s.click(),window.URL.revokeObjectURL(l),e()}catch(s){i(s)}})})})},_getUrl(t){let e=t.url,i=t.param?t.param:{};if(!h.isEmpty(i)){let r="?";for(let n in i){let s=i[n];h.isEmpty(s)||(r=r+n+"="+s+"&")}r!=="?"?r=r.substring(0,r.length-1):r="",e=e+r}return e}};class C{constructor(e){this.data={},this.url=e}$send(e,i){return new Promise((r,n)=>{let s=e.url,l=e.type,a=e.header,f=e.data,o=e.param;if(h.isEmpty(s))throw new O("\u65B9\u6CD5\u540D is null");if(h.isEmpty(l))throw new O("type is null");h.isEmpty(this.data[s])&&(this.data[s]={request:null,response:null}),f!=null&&(this.data[s].request=f),(h.isEmpty(i)||i===void 0)&&(i=()=>{});let c={url:this.url+"/"+s,type:l,header:a,data:this.data[s].request,param:o};i(c),this.$requestHandler(c),v.send(c).then(d=>{h.clean(this.data[s].response);let y;try{y=JSON.parse(d)}catch{y=d}h.isObject(this.data[s].response)?(h.addKey(this.data[s].response,y),h.assignment(this.data[s].response,y)):this.data[s].response=y,r(this.data[s].response)}).catch(d=>{n(d)})})}$download(e,i){return new Promise((r,n)=>{let s=e.url,l=e.param;if(h.isEmpty(s))throw new O("\u65B9\u6CD5\u540D is null");h.isEmpty(this.data[s])&&(this.data[s]={request:null,response:null}),l!==void 0&&(this.data[s].request=l),(i===void 0||h.isEmpty(i))&&(i=()=>{});let a={url:this.url+"/"+s,type:p.GET,param:this.data[s].request};i(a),this.$requestHandler(a),v.download(a).then(()=>{r()}).catch(f=>{n(f)})})}$requestHandler(e){}$addData(e,i,r){i===void 0&&(i=null),r===void 0&&(r=null),this.data[e]={request:i,response:r}}}class E extends C{constructor(e){super(e),this.data={}}$send(e,i){return new Promise((r,n)=>{super.$send(e,i).then(s=>{s.flag?r(s):n(s)}).catch(s=>{n(s)})})}}class D extends E{constructor(e,i,r){super(e),this.data={query:{request:new T({filter:r}),response:new g({result:new S})},save:{request:h.clone(i),response:new g},saveList:{request:[],response:new g},delete:{request:h.clone(i),response:new g},deleteList:{request:[],response:new g}}}query(e){return this.$send({url:"query",type:p.POST,data:e})}save(e){return this.$send({url:"save",type:p.POST,data:e})}saveList(e){return this.$send({url:"saveList",type:p.POST,data:e})}doDelete(e){return this.$send({url:"delete",type:p.POST,data:e})}deleteList(e){return this.$send({url:"deleteList",type:p.POST,data:e})}}let m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",P=function(t){let e="";t=t.replace(/\r\n/g,`
`);for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(r&63|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(r&63|128))}return e},b=function(t){let e="",i=0,r,n,s=0;for(;i<t.length;)r=t.charCodeAt(i),r<128?(e+=String.fromCharCode(r),i++):r>191&&r<224?(n=t.charCodeAt(i+1),e+=String.fromCharCode((r&31)<<6|n&63),i+=2):(n=t.charCodeAt(i+1),s=t.charCodeAt(i+2),e+=String.fromCharCode((r&15)<<12|(n&63)<<6|s&63),i+=3);return e};var L={encode(t){let e="",i,r,n,s,l,a,f,o=0;for(t=P(t);o<t.length;)i=t.charCodeAt(o++),r=t.charCodeAt(o++),n=t.charCodeAt(o++),s=i>>2,l=(i&3)<<4|r>>4,a=(r&15)<<2|n>>6,f=n&63,isNaN(r)?a=f=64:isNaN(n)&&(f=64),e=e+m.charAt(s)+m.charAt(l)+m.charAt(a)+m.charAt(f);return e},decode(t){let e="",i,r,n,s,l,a,f,o=0;for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");o<t.length;)s=m.indexOf(t.charAt(o++)),l=m.indexOf(t.charAt(o++)),a=m.indexOf(t.charAt(o++)),f=m.indexOf(t.charAt(o++)),i=s<<2|l>>4,r=(l&15)<<4|a>>2,n=(a&3)<<6|f,e=e+String.fromCharCode(i),a!==64&&(e=e+String.fromCharCode(r)),f!==64&&(e=e+String.fromCharCode(n));return e=b(e),e}},N={select(){return new Promise(t=>{let e=document.createElement("input");e.type="file",e.addEventListener("change",function(){let i=e.files;i===null?t():t(i[0])}),e.click()})},selectMore(){return new Promise(t=>{let e=document.createElement("input");e.type="file",e.multiple=!0,e.addEventListener("change",function(){let i=e.files;t(i)}),e.click()})}},$={then(t,e){return new Promise((i,r)=>{t.then(n=>{e(n),i(n)}).catch(n=>{r(n)})})}},U={create(t){return{loading:!1,display:!1,...t,async open(e){this.display=!0,this.loading=!0,t.openHandler&&await t.openHandler(e),this.loading=!1},close(){this.display=!1}}}};u.BasePO=k,u.BaseService=E,u.DatabaseService=D,u.HttpRequest=A,u.InfoException=O,u.Query=T,u.QueryResult=S,u.ResponseResult=g,u.Service=C,u.base64=L,u.file=N,u.http=v,u.httpType=p,u.popupUtil=U,u.promise=$,u.variable=h,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
