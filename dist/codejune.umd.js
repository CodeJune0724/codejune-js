(function(c,y){typeof exports=="object"&&typeof module<"u"?y(exports):typeof define=="function"&&define.amd?define(["exports"],y):(c=typeof globalThis<"u"?globalThis:c||self,y(c.codejune={}))})(this,function(c){"use strict";var y="";class m extends Error{constructor(t){super(t)}}class w{constructor(t){this.url=t.url,this.type=t.type,this.header=t.header,this.param=t.param,this.body=t.body,this.config=t.config}}var p=(e=>(e.POST="POST",e.GET="GET",e.PUT="PUT",e.DELETE="DELETE",e))(p||{}),u={isNull(e){return e==null},isEmpty(e){if(this.isNull(e))return!0;let t=this.getType(e);return t===String&&e===""||t===Array&&e.length===0?!0:t===Object&&Object.keys(e).length===0},getType(e){return this.isNull(e)?null:e.constructor},isObject(e){if(this.isNull(e))return!1;if(e instanceof Object){let t=this.getType(e);return t==null?!1:JSON.stringify(e)!==void 0||t.toString().indexOf("class")===0||t===Array?!0:t===Object}return!1},clone(e){if(this.isObject(e))if(this.getType(e)===Array){let t=[];for(let i of e)t.push(this.clone(i));return t}else{let t={};for(let i in e)t[i]=this.clone(e[i]);return t}else return this.isNull(e)?null:e},assignment(e,t,i){let r=this.getType(e),l=this.isEmpty(i)?!0:i===!0;if(!(!this.isObject(e)||!this.isObject(t)))if(r===Array){let n=!0;if(l&&this.getType(t)!==Array&&(n=!1),r!==this.getType(t)&&(n=!1),n){e.splice(0,e.length);for(let s of t)e.push(s)}}else if(l)for(let n in e){let s=e[n],f=t[n];if(s===void 0||f===void 0)continue;let o=!1;(s===null||f===null&&!this.isObject(s)||this.getType(s)===this.getType(f))&&(o=!0),o&&(this.isObject(f)&&(f=this.clone(f)),this.isObject(s)&&this.isObject(f)?this.assignment(s,f,!0):e[n]=f)}else for(let n in t){let s=t[n];s!==void 0&&(this.isObject(s)&&(s=this.clone(s)),e[n]=s)}},toStr(e){return this.isNull(e)?null:this.isObject(e)?JSON.stringify(e):e.toString()},clean(e){if(e instanceof Array)e.splice(0);else if(this.isObject(e))for(let t in e){let i=e[t];this.isObject(i)?this.clean(i):e[t]=null}},addKey(e,t){if(!(!this.isObject(e)||!this.isObject(t)))for(let i in t){let r=t[i];this.isNull(e[i])&&(this.isObject(r)?this.getType(r)===Array?e[i]=[]:e[i]={}:e[i]=null),this.addKey(e[i],r)}},filterKey(e,t){for(let i in e)t.indexOf(i)===-1&&delete e[i]}},g={send(e){return new Promise((t,i)=>{this._getFetch(e).then(r=>{let l=r.text();r.ok?t(l):i(l)}).catch(r=>{i(r)})})},download(e){return new Promise((t,i)=>{try{window.open(this._getUrl(e)),t()}catch(r){i(r)}})},asyncDownload(e){return new Promise((t,i)=>{this._getFetch(e).then(r=>{let l=r.headers.get("Content-Type");l&&l.indexOf("download")!==-1?r.blob().then(n=>{try{let s=document.createElement("a"),f=window.URL.createObjectURL(n),o=r.headers.get("Content-Disposition");o=o||"";let d=/filename=(.*?)$/g.exec(o);d!==null&&(o=d[1]),s.href=f,s.download=decodeURI(o),s.click(),window.URL.revokeObjectURL(f),t()}catch(s){i(s)}}):r.text().then(n=>{i(n)})})})},_getUrl(e){let t=e.url,i=e.param?e.param:{};if(!u.isEmpty(i)){let r="?";for(let l in i){let n=i[l];u.isEmpty(n)||(r=r+l+"="+n+"&")}r!=="?"?r=r.substring(0,r.length-1):r="",t=t+r}return t},_getFetch(e){let t=this._getUrl(e),i=e.type,r=e.header?e.header:{},l=e.body,n=e.config,s=!1;if(u.isObject(l)){for(let f in l){let o=u.getType(l[f]);if(o===File||o===FileList){s=!0;break}if(o===Array){for(let h of l[f])if(u.getType(h)===File||u.getType(h)===FileList){s=!0;break}}}if(s){let f=new FormData;for(let o in l){let h=l[o];if(u.getType(h)===FileList)for(let d of h)f.append(o,d);else if(u.getType(h)===Array)for(let d of h)f.append(o,d);else f.append(o,h)}l=f}}if(u.isObject(l)&&u.getType(l)!==FormData){let f="BODY";switch(n&&n.dataType&&(f=n.dataType),f){case"BODY":l=JSON.stringify(l);break;case"FORM_DATA":let o=new FormData;for(let h in l)o.append(h,l[h]);l=o;break}}return i!==p.GET&&!s&&(r["content-type"]="application/json"),fetch(t,{cache:"no-cache",credentials:"same-origin",mode:"cors",redirect:"follow",referrer:"no-referrer",method:i,headers:r,body:i!==p.GET?l:void 0})}};let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",O=function(e){let t="";e=e.replace(/\r\n/g,`
`);for(let i=0;i<e.length;i++){let r=e.charCodeAt(i);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},T=function(e){let t="",i=0,r,l,n=0;for(;i<e.length;)r=e.charCodeAt(i),r<128?(t+=String.fromCharCode(r),i++):r>191&&r<224?(l=e.charCodeAt(i+1),t+=String.fromCharCode((r&31)<<6|l&63),i+=2):(l=e.charCodeAt(i+1),n=e.charCodeAt(i+2),t+=String.fromCharCode((r&15)<<12|(l&63)<<6|n&63),i+=3);return t};var C={encode(e){let t="",i,r,l,n,s,f,o,h=0;for(e=O(e);h<e.length;)i=e.charCodeAt(h++),r=e.charCodeAt(h++),l=e.charCodeAt(h++),n=i>>2,s=(i&3)<<4|r>>4,f=(r&15)<<2|l>>6,o=l&63,isNaN(r)?f=o=64:isNaN(l)&&(o=64),t=t+a.charAt(n)+a.charAt(s)+a.charAt(f)+a.charAt(o);return t},decode(e){let t="",i,r,l,n,s,f,o,h=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<e.length;)n=a.indexOf(e.charAt(h++)),s=a.indexOf(e.charAt(h++)),f=a.indexOf(e.charAt(h++)),o=a.indexOf(e.charAt(h++)),i=n<<2|s>>4,r=(s&15)<<4|f>>2,l=(f&3)<<6|o,t=t+String.fromCharCode(i),f!==64&&(t=t+String.fromCharCode(r)),o!==64&&(t=t+String.fromCharCode(l));return t=T(t),t}},v={select(){return new Promise(e=>{let t=document.createElement("input");t.type="file",t.addEventListener("change",function(){let i=t.files;i===null?e():e(i[0])}),t.click()})},selectMore(){return new Promise(e=>{let t=document.createElement("input");t.type="file",t.multiple=!0,t.addEventListener("change",function(){let i=t.files;e(i)}),t.click()})}};class A{constructor(t){this.url=t}$send(t){return new Promise((i,r)=>{g.send(this._getHttpRequest(t)).then(l=>{let n;try{n=JSON.parse(l)}catch{n=l}i(n)}).catch(l=>{r(l)})})}$download(t){return new Promise((i,r)=>{g.download(this._getHttpRequest(t)).then(()=>{i()}).catch(l=>{r(l)})})}$asyncDownload(t){return new Promise((i,r)=>{g.asyncDownload(this._getHttpRequest(t)).then(()=>{i()}).catch(l=>{r(l)})})}$requestHandler(t){}_getHttpRequest(t){let i=t.url,r=t.type,l=t.header,n=t.body,s=t.param;if(u.isEmpty(i))throw new m("url is null");if(u.isEmpty(r))throw new m("type is null");let f={url:i.indexOf("http")!==-1?i:this.url+"/"+i,type:r,header:l,body:n,param:s};return this.$requestHandler(f),f}}var S={create(e){let t={loading:!1,display:!1,...e,async open(i){this.display=!0,this.loading=!0,e.openHandler&&await e.openHandler(i),this.loading=!1},close(){this.display=!1}};return e.close&&(t.close=e.close),t}},E={getScreenHeight(){return window.screen.height}};c.HttpRequest=w,c.InfoException=m,c.Service=A,c.base64=C,c.file=v,c.http=g,c.httpType=p,c.popup=S,c.variable=u,c.window=E,Object.defineProperties(c,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
