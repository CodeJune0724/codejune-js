(function(c,u){typeof exports=="object"&&typeof module<"u"?u(exports):typeof define=="function"&&define.amd?define(["exports"],u):(c=typeof globalThis<"u"?globalThis:c||self,u(c.codejune={}))})(this,function(c){"use strict";const u="";class m extends Error{constructor(e){super(e)}}const d={isNull(i){return i==null},isEmpty(i){return this.isNull(i)?!0:typeof i=="object"?Object.keys(i).length===0:typeof i=="string"?i.trim()==="":typeof i=="number"?isNaN(i)||i===0:typeof i!="boolean"},clone(i){if(this.isNull(i))return i;if(Array.isArray(i)){let e=[];for(let t of i)e.push(this.clone(t));return e}else{let e={};for(let t in i){let r=i[t];r!==void 0&&(typeof r=="object"?e[t]=this.clone(r):e[t]=r)}return e}},assignment(i,e,t){if(!this.isNull(t)&&t===!0)for(let r in i){let n=i[r],o=e[r];if(!(n===void 0||o===void 0)){if(n===null){i[r]=o;continue}if(typeof n=="object"){if(typeof o=="object"){if(Array.isArray(n)&&Array.isArray(o)){n=[];for(let l of o)n.push(l);i[r]=n;continue}!Array.isArray(n)&&!Array.isArray(o)&&this.assignment(n,o,!0)}}else typeof n==typeof o&&(i[r]=o)}}else for(let r in e){let n=e[r];n!==void 0&&(i[r]=n)}},toStr(i){return this.isNull(i)?`${i}`:typeof i=="object"?JSON.stringify(i):i.toString()},clean(i){for(let e in i){let t=i[e];this.isNull(t)||(typeof t=="object"?Array.isArray(t)?i[e]=[]:this.clean(t):i[e]=null)}}};class y{url="";type="GET";param={};header={};contentType=null;body=null;constructor(e,t){this.url=e,this.type=t}addHeader(e,t){this.header[e]=t}addParam(e,t){this.param[e]=t}setContentType(e){this.contentType=e;let t="Content-type";switch(e){case"APPLICATION_JSON":this.header[t]="application/json";break;case"APPLICATION_XML":this.header[t]="application/xml";break;case"ROW":this.header[t]="text/plain";break;case null:delete this.header[t];break}}setBody(e){this.body=e}send(){return new Promise((e,t)=>{this._getFetch().then(r=>{let n=r.text();r.ok?e(n):t(n)}).catch(r=>{t(r)})})}download(){return new Promise((e,t)=>{try{window.open(this._getUrl()),e()}catch(r){t(r)}})}asyncDownload(){return new Promise((e,t)=>{this._getFetch().then(r=>{let n=r.headers.get("Content-Type");n&&n.indexOf("download")!==-1?r.blob().then(o=>{try{let l=document.createElement("a"),h=window.URL.createObjectURL(o),s=r.headers.get("Content-Disposition");s=s||"";let p=/filename=(.*?)$/g.exec(s);p!==null&&(s=p[1]),l.href=h,l.download=decodeURI(s),l.click(),window.URL.revokeObjectURL(h),e()}catch(l){t(l)}}):r.text().then(o=>{t(o)})})})}_getFetch(){if(!d.isNull(this.body)&&typeof this.body=="object"){let e=t=>{if(d.isNull(t))return!1;if(t.constructor===File||t.constructor===FileList)return!0;for(let r in t){let n=this.body[r];if(e(n))return!0}return!1};e(this.body)&&(this.contentType="FORM_DATA")}if(this.contentType==="FORM_DATA"){delete this.header["Content-type"];let e=new FormData;if(!d.isNull(this.body)&&typeof this.body=="object")for(let t in this.body){let r=this.body[t];if(r!==void 0)if(!d.isNull(r)&&(r.constructor===FileList||Array.isArray(r)))for(let n of r)e.append(t,n);else e.append(t,r)}this.body=e}else d.isNull(this.body)&&typeof this.body=="object"&&(this.body=JSON.stringify(this.body));return fetch(this._getUrl(),{cache:"no-cache",credentials:"same-origin",mode:"cors",redirect:"follow",referrer:"no-referrer",method:this.type,headers:this.header,body:this.type!=="GET"?this.body:void 0})}_getUrl(){let e=this.url;if(!d.isEmpty(this.param)){let t="?";for(let r in this.param){let n=this.param[r];n&&(t=t+r+"="+n+"&")}t!=="?"?t=t.substring(0,t.length-1):t="",e=e+t}return e}}let a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",b=function(i){let e="";i=i.replace(/\r\n/g,`
`);for(let t=0;t<i.length;t++){let r=i.charCodeAt(t);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(r&63|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(r&63|128))}return e},g=function(i){let e="",t=0,r,n,o=0;for(;t<i.length;)r=i.charCodeAt(t),r<128?(e+=String.fromCharCode(r),t++):r>191&&r<224?(n=i.charCodeAt(t+1),e+=String.fromCharCode((r&31)<<6|n&63),t+=2):(n=i.charCodeAt(t+1),o=i.charCodeAt(t+2),e+=String.fromCharCode((r&15)<<12|(n&63)<<6|o&63),t+=3);return e};const w={encode(i){let e="",t,r,n,o,l,h,s,f=0;for(i=b(i);f<i.length;)t=i.charCodeAt(f++),r=i.charCodeAt(f++),n=i.charCodeAt(f++),o=t>>2,l=(t&3)<<4|r>>4,h=(r&15)<<2|n>>6,s=n&63,isNaN(r)?h=s=64:isNaN(n)&&(s=64),e=e+a.charAt(o)+a.charAt(l)+a.charAt(h)+a.charAt(s);return e},decode(i){let e="",t,r,n,o,l,h,s,f=0;for(i=i.replace(/[^A-Za-z0-9\+\/\=]/g,"");f<i.length;)o=a.indexOf(i.charAt(f++)),l=a.indexOf(i.charAt(f++)),h=a.indexOf(i.charAt(f++)),s=a.indexOf(i.charAt(f++)),t=o<<2|l>>4,r=(l&15)<<4|h>>2,n=(h&3)<<6|s,e=e+String.fromCharCode(t),h!==64&&(e=e+String.fromCharCode(r)),s!==64&&(e=e+String.fromCharCode(n));return e=g(e),e}},C={select(){return new Promise(i=>{let e=document.createElement("input");e.type="file",e.addEventListener("change",function(){let t=e.files;t===null?i():i(t[0])}),e.click()})},selectMore(){return new Promise(i=>{let e=document.createElement("input");e.type="file",e.multiple=!0,e.addEventListener("change",function(){let t=e.files;i(t)}),e.click()})}};class A{url;constructor(e){this.url=e}$send(e){return new Promise((t,r)=>{this._getHttp(e).send().then(n=>{let o;try{o=JSON.parse(n)}catch{o=n}t(o)}).catch(n=>{r(n)})})}$download(e){return new Promise((t,r)=>{this._getHttp(e).download().then(()=>{t()}).catch(n=>{r(n)})})}$asyncDownload(e){return new Promise((t,r)=>{this._getHttp(e).asyncDownload().then(()=>{t()}).catch(n=>{r(n)})})}_getHttp(e){e.url=e.url.startsWith("http")?e.url:this.url?`${this.url}${e.url?e.url.startsWith("/")?e.url:`/${e.url}`:""}`:e.url;let t=new y(e.url,e.type);if(e.header)for(let r in e.header)t.addHeader(r,e.header[r]);if(e.param)for(let r in e.param)t.addParam(r,e.param[r]);return t.setBody(e.body),t.contentType===null&&e.type!=="GET"&&typeof e.body=="object"&&t.setContentType("APPLICATION_JSON"),t}}const k={create(i){let e={loading:!1,display:!1,...i,async open(t){this.display=!0,this.loading=!0,i.openHandler&&await i.openHandler(t),this.loading=!1},close(){this.display=!1}};return i.close&&(e.close=i.close),e}},N={getScreenHeight(){return window.screen.height}};class S{url="";websocket=null;onOpen=()=>{};onMessage=()=>{};onClose=()=>{};onError=()=>{};constructor(e){this.url=e}open(){this.websocket=new WebSocket(this.url),this.websocket.onopen=e=>{this.onOpen(e)},this.websocket.onmessage=e=>{this.onMessage(e)},this.websocket.onclose=e=>{this.onClose(e)},this.websocket.onerror=e=>{this.onError(e)}}send(e){this.websocket&&(e instanceof Blob||e instanceof ArrayBuffer||typeof e=="string"?this.websocket.send(e):this.websocket.send(JSON.stringify(e)))}close(){this.websocket&&(this.websocket.close(),this.websocket=null)}}c.Http=y,c.InfoException=m,c.Service=A,c.Websocket=S,c.base64=w,c.file=C,c.popup=k,c.variable=d,c.window=N,Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})});
